{
  "version": "alpha-05",
  "isAllowedTests": [
    {
      "id": "basic allow match",
      "permissions": ["allow:blog/read"],
      "actions": ["blog/read"],
      "result": true
    },
    {
      "id": "basic deny match",
      "permissions": ["deny:blog/read"],
      "actions": ["blog/read"],
      "result": false
    },
    {
      "id": "no match is deny",
      "permissions": ["deny:blog/read"],
      "actions": ["accounts/read"],
      "result": false
    },
    {
      "id": "no match is deny 2",
      "permissions": ["deny:blog/read"],
      "actions": ["blog/reader"],
      "result": false
    },
    {
      "id": "permissions shorter then actions",
      "permissions": ["allow:blog/public"],
      "actions": ["blog/public/read"],
      "result": false
    },
    {
      "id": "actions shorter then permissions",
      "permissions": ["allow:blog/public/read"],
      "actions": ["blog/public"],
      "result": false
    },
    {
      "id": "match with array",
      "permissions": ["allow:pzazz/jazzy/fuzzy|folky|buzzy"],
      "actions": ["pzazz/jazzy/buzzy"],
      "result": true
    },
    {
      "id": "match with variable",
      "permissions": ["allow:quick/zappy/@name01"],
      "actions": ["quick/zappy/value01"],
      "variables": {
          "name01": "value01"
      },
      "result": true
    },
    {
      "id": "match with wildcard",
      "permissions": ["allow:alamo/aline/*"],
      "actions": ["alamo/aline/anchor"],
      "variables": {
          "name01": "value01"
      },
      "result": true
    },
    {
      "id": "permissions permission has more wildcards then actions permission",
      "permissions": ["allow:*/*/*"],
      "actions": ["alamo/anchor"],
      "result": false
    },
    {
      "id": "match with super wildcard",
      "permissions": ["allow:antic/**"],
      "actions": ["antic/apeek/antre"],
      "variables": {
          "name01": "value01"
      },
      "result": true
    },
    {
      "id": "invalid special character in permissions",
      "permissions": ["allow:blog/:155"],
      "actions": ["blog/read"],
      "error": "scopie-100 in permission: invalid character ':'"
    },
    {
      "id": "invalid special character in actions",
      "permissions": ["allow:blog/read"],
      "actions": ["blog/:155"],
      "error": "scopie-100 in action: invalid character ':'"
    },
    {
      "id": "variable inside an array group",
      "permissions": ["allow:blog/read|@group|write"],
      "actions": ["blog/exec"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "variable and the end of an array group",
      "permissions": ["allow:blog/read|write|@group"],
      "actions": ["blog/exec"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "wildcard inside an array group",
      "permissions": ["allow:blog/read|*|write"],
      "actions": ["blog/exec"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "wildcard at the end of an array group",
      "permissions": ["allow:blog/read|write|*"],
      "actions": ["blog/exec"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "super wildcard inside an array group",
      "permissions": ["allow:blog/read|**|write"],
      "actions": ["blog/exec"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "super wildcard at the end of an array group",
      "permissions": ["allow:blog/read|write|**"],
      "actions": ["blog/exec"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "variable not found",
      "permissions": ["allow:blog/@group","allow:blog/read"],
      "actions": ["blog/exec"],
      "variables": {
          "name01": "value01"
      },
      "error": "scopie-104: variable 'group' not found"
    },
    {
      "id": "variable not found 2",
      "permissions": ["allow:blog/@group"],
      "actions": ["blog/exec"],
      "variables": {
          "name01": "value01"
      },
      "error": "scopie-104: variable 'group' not found"
    },
    {
      "id": "super wildcard not in the last block",
      "permissions": ["allow:blog/**/create"],
      "actions": ["blog/exec"],
      "error": "scopie-105: super wildcard not in the last block"
    },
    {
      "id": "empty permissions array",
      "permissions": [],
      "actions": ["blog/exec"],
      "result": false
    },
    {
      "id": "empty permissions permission",
      "permissions": [""],
      "actions": ["blog/exec"],
      "error": "scopie-106 in permission: permission was empty"
    },
    {
      "id": "empty actions array",
      "permissions": ["allow:accounts/read"],
      "actions": [],
      "error": "scopie-106 in action: actions was empty"
    },
    {
      "id": "empty actions permission",
      "permissions": ["allow:accounts/read"],
      "actions": [""],
      "error": "scopie-106 in action: action was empty"
    },
    {
      "id": "permission does not start with grant",
      "permissions": ["maybe:accounts/read"],
      "actions": ["accounts/read"],
      "error": "scopie-107: permission does not start with a grant"
    },
    {
      "id": "permission does not start with grant when second permission",
      "permissions": ["deny:admin/write", "maybe:accounts/read"],
      "actions": ["accounts/read"],
      "error": "scopie-107: permission does not start with a grant"
    }
  ],
  "validateActionsTests": [
    {
      "id": "simple action",
      "actions": ["blog/read"]
    },
    {
      "id": "cased action",
      "actions": ["Blog/Write"]
    },
    {
      "id": "numbered action",
      "actions": ["Blog/Write100"]
    },
    {
      "id": "special character action",
      "actions": ["Blog/Delete-500"]
    },
    {
      "id": "invalid special character",
      "actions": ["blog/:15"],
      "error": "scopie-100: invalid character ':'"
    },
    {
      "id": "invalid with wildcard",
      "actions": ["blog/*"],
      "error": "scopie-100: invalid character '*'"
    },
    {
      "id": "invalid with var prefix",
      "actions": ["blog/@"],
      "error": "scopie-100: invalid character '@'"
    },
    {
      "id": "invalid with array separator",
      "actions": ["blog/a|b"],
      "error": "scopie-100: invalid character '|'"
    },
    {
      "id": "empty action array",
      "actions": [],
      "error": "scopie-106: action array was empty"
    },
    {
      "id": "empty action",
      "actions": [""],
      "error": "scopie-106: action was empty"
    },
    {
      "id": "empty action at second index",
      "actions": ["blog/delete", ""],
      "error": "scopie-106: action was empty"
    }
  ],
  "validatePermissionsTests": [
    {
      "id": "simple permission",
      "permissions": ["allow:blog/read"]
    },
    {
      "id": "with wildcard",
      "permissions": ["allow:blog/*/read"]
    },
    {
      "id": "with super wildcard",
      "permissions": ["allow:blog/**"]
    },
    {
      "id": "with array",
      "permissions": ["allow:blog/primary|secondary|third/read"]
    },
    {
      "id": "with variable",
      "permissions": ["allow:blog/@owner/read"]
    },
    {
      "id": "combination",
      "permissions": ["allow:blog/*/@region/primary|secondary/**"]
    },
    {
      "id": "empty permissions",
      "permissions": [],
      "error": "scopie-106: permission array was empty"
    },
    {
      "id": "invalid start",
      "permissions": ["maybe:blog/create"],
      "error": "scopie-107: permission does not start with a grant"
    },
    {
      "id": "invalid special character",
      "permissions": ["allow:blog/+15"],
      "error": "scopie-100: invalid character '+'"
    },
    {
      "id": "variable inside an array group",
      "permissions": ["allow:blog/read|@group|write"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "variable and the end of an array group",
      "permissions": ["allow:blog/read|write|@group"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "wildcard inside an array group",
      "permissions": ["allow:blog/read|*|write"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "wildcard at the end of an array group",
      "permissions": ["allow:blog/read|write|*"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "super wildcard inside an array group",
      "permissions": ["allow:blog/read|**|write"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "super wildcard at the end of an array group",
      "permissions": ["allow:blog/read|write|**"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "super wildcard not in the last block",
      "permissions": ["allow:blog/**/create"],
      "error": "scopie-105: super wildcard not in the last block"
    },
    {
      "id": "empty permission",
      "permissions": [""],
      "error": "scopie-106: permission was empty"
    },
    {
      "id": "empty permission at second index",
      "permissions": ["allow:blog/**", ""],
      "error": "scopie-106: permission was empty"
    }
  ],
  "benchmarks": [
    {
      "id": "allow,1permissions,1permission,1block1length",
      "permissions": ["allow:A"],
      "actions": ["A"],
      "result": true
    },
    {
      "id": "deny,1permissions,1permission,1block1length",
      "permissions": ["deny:A"],
      "actions": ["A"],
      "result": false
    },
    {
      "id": "allow,5permissions,3actions,3blocks10length,best",
      "permissions": ["allow:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "allow:buzzworthy/bemuzzling/jazzercise"],
      "actions": ["razzmatazz/vajazzling/buckjumper", "buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging"],
      "result": true
    },
    {
      "id": "allow,5permissions,3actions,3blocks10length,worst",
      "permissions": ["allow:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "allow:buzzworthy/bemuzzling/jazzercise"],
      "actions": ["buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging", "buzzworthy/bemuzzling/jazzercise"],
      "result": true
    },
    {
      "id": "deny,5permissions,3actions,3blocks10length,best",
      "permissions": ["deny:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "allow:buzzworthy/bemuzzling/jazzercise"],
      "actions": ["razzmatazz/vajazzling/buckjumper", "buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging"],
      "result": false
    },
    {
      "id": "deny,5permissions,3actions,3blocks10length,worst",
      "permissions": ["allow:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "deny:buzzworthy/bemuzzling/jazzercise"],
      "actions": ["buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging", "buzzworthy/bemuzzling/jazzercise"],
      "result": false
    },
    {
      "id": "allow,2permissions,1permission,3block5length,3array,best",
      "permissions": ["allow:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "allow:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "actions": ["pzazz/jazzy/buzzy"],
      "result": true
    },
    {
      "id": "allow,2permissions,1permission,3block5length,3array,worst",
      "permissions": ["allow:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "allow:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "actions": ["abuzz/frizz/mezzo"],
      "result": true
    },
    {
      "id": "deny,2permissions,1permission,3block5length,3array,best",
      "permissions": ["deny:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "allow:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "actions": ["pzazz/jazzy/buzzy"],
      "result": false
    },
    {
      "id": "deny,2permissions,1permission,3block5length,3array,worst",
      "permissions": ["allow:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "deny:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "actions": ["abuzz/frizz/mezzo"],
      "result": false
    },
    {
      "id": "allow,3permissions,1permission,3block5length,3variables,best",
      "permissions": ["allow:@name01/@name02/@name03", "allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack"],
      "actions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": true
    },
    {
      "id": "allow,3permissions,1permission,3block5length,3variables,worst",
      "permissions": ["allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack", "allow:@name01/@name02/@name03"],
      "actions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": true
    },
    {
      "id": "deny,2permissions,1permission,3block5length,3variables,best",
      "permissions": ["deny:@name01/@name02/@name03", "allow:quick/zappy/zippy", "allow:jacks/jocko/jugum"],
      "actions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": false
    },
    {
      "id": "deny,2permissions,1permission,3block5length,3variables,worst",
      "permissions": ["allow:quick/zappy/zippy", "allow:jacks/jocko/jugum", "deny:@name01/@name02/@name03"],
      "actions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": false
    },
    {
      "id": "allow,3permissions,1permission,3block5length,wildcard,best",
      "permissions": ["allow:jivey/*/juicy", "allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack"],
      "actions": ["jivey/juked/juicy"],
      "result": true
    },
    {
      "id": "allow,3permissions,1permission,3block5length,wildcard,worst",
      "permissions": ["allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack", "allow:juffs/*/jaggy"],
      "actions": ["juffs/jokey/jaggy"],
      "result": true
    },
    {
      "id": "deny,2permissions,1permission,3block5length,wildcard,best",
      "permissions": ["deny:khazi/*/pujah", "allow:quick/zappy/zippy", "allow:jacks/jocko/jugum"],
      "actions": ["khazi/zincy/pujah"],
      "result": false
    },
    {
      "id": "deny,2permissions,1permission,3block5length,wildcard,worst",
      "permissions": ["allow:quick/zappy/zippy", "allow:jacks/jocko/jugum", "deny:zilch/*/kanzu"],
      "actions": ["zilch/karzy/kanzu"],
      "result": false
    },
    {
      "id": "allow,3permissions,1permission,3block5length,superwildcard,best",
      "permissions": ["allow:jivey/**", "allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack"],
      "actions": ["jivey/juked/juicy"],
      "result": true
    },
    {
      "id": "allow,3permissions,1permission,3block5length,superwildcard,worst",
      "permissions": ["allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack", "allow:juffs/**"],
      "actions": ["juffs/jokey/jaggy"],
      "result": true
    },
    {
      "id": "deny,2permissions,1permission,3block5length,superwildcard,best",
      "permissions": ["deny:khazi/**", "allow:quick/zappy/zippy", "allow:jacks/jocko/jugum"],
      "actions": ["khazi/zincy/pujah"],
      "result": false
    },
    {
      "id": "deny,2permissions,1permission,3block5length,superwildcard,worst",
      "permissions": ["allow:quick/zappy/zippy", "allow:jacks/jocko/jugum", "deny:zilch/**"],
      "actions": ["zilch/karzy/kanzu"],
      "result": false
    }
  ]
}
