{
  "version": "alpha-04",
  "isAllowedTests": [
    {
      "id": "basic allow match",
      "actions": ["allow:blog/read"],
      "permissions": ["blog/read"],
      "result": true
    },
    {
      "id": "basic deny match",
      "actions": ["deny:blog/read"],
      "permissions": ["blog/read"],
      "result": false
    },
    {
      "id": "no match is deny",
      "actions": ["deny:blog/read"],
      "permissions": ["accounts/read"],
      "result": false
    },
    {
      "id": "no match is deny 2",
      "actions": ["deny:blog/read"],
      "permissions": ["blog/reader"],
      "result": false
    },
    {
      "id": "actions shorter then permissions",
      "actions": ["allow:blog/public"],
      "permissions": ["blog/public/read"],
      "result": false
    },
    {
      "id": "permissions shorter then actions",
      "actions": ["allow:blog/public/read"],
      "permissions": ["blog/public"],
      "result": false
    },
    {
      "id": "match with array",
      "actions": ["allow:pzazz/jazzy/fuzzy|folky|buzzy"],
      "permissions": ["pzazz/jazzy/buzzy"],
      "result": true
    },
    {
      "id": "match with variable",
      "actions": ["allow:quick/zappy/@name01"],
      "permissions": ["quick/zappy/value01"],
      "variables": {
          "name01": "value01"
      },
      "result": true
    },
    {
      "id": "match with wildcard",
      "actions": ["allow:alamo/aline/*"],
      "permissions": ["alamo/aline/anchor"],
      "variables": {
          "name01": "value01"
      },
      "result": true
    },
    {
      "id": "actions with more wildcards then permissions",
      "actions": ["allow:*/*/*"],
      "permissions": ["alamo/anchor"],
      "result": false
    },
    {
      "id": "match with super wildcard",
      "actions": ["allow:antic/**"],
      "permissions": ["antic/apeek/antre"],
      "variables": {
          "name01": "value01"
      },
      "result": true
    },
    {
      "id": "invalid special character in actions",
      "actions": ["allow:blog/:155"],
      "permissions": ["blog/read"],
      "error": "scopie-100 in action: invalid character ':'"
    },
    {
      "id": "invalid special character in permissions",
      "actions": ["allow:blog/read"],
      "permissions": ["blog/:155"],
      "error": "scopie-100 in permission invalid character ':'"
    },
    {
      "id": "variable inside an array group",
      "actions": ["allow:blog/read|@group|write"],
      "permissions": ["blog/exec"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "variable and the end of an array group",
      "actions": ["allow:blog/read|write|@group"],
      "permissions": ["blog/exec"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "wildcard inside an array group",
      "actions": ["allow:blog/read|*|write"],
      "permissions": ["blog/exec"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "wildcard at the end of an array group",
      "actions": ["allow:blog/read|write|*"],
      "permissions": ["blog/exec"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "super wildcard inside an array group",
      "actions": ["allow:blog/read|**|write"],
      "permissions": ["blog/exec"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "super wildcard at the end of an array group",
      "actions": ["allow:blog/read|write|**"],
      "permissions": ["blog/exec"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "variable not found",
      "actions": ["allow:blog/@group","allow:blog/read"],
      "permissions": ["blog/exec"],
      "variables": {
          "name01": "value01"
      },
      "error": "scopie-104: variable 'group' not found"
    },
    {
      "id": "variable not found 2",
      "actions": ["allow:blog/@group"],
      "permissions": ["blog/exec"],
      "variables": {
          "name01": "value01"
      },
      "error": "scopie-104: variable 'group' not found"
    },
    {
      "id": "super wildcard not in the last block",
      "actions": ["allow:blog/**/create"],
      "permissions": ["blog/exec"],
      "error": "scopie-105: super wildcard not in the last block"
    },
    {
      "id": "empty actions array",
      "actions": [],
      "permissions": ["blog/exec"],
      "result": false
    },
    {
      "id": "empty action",
      "actions": [""],
      "permissions": ["blog/exec"],
      "error": "scopie-106 in action: action was empty"
    },
    {
      "id": "empty permissions array",
      "actions": ["allow:accounts/read"],
      "permissions": [],
      "error": "scopie-106 in permission permissions was empty"
    },
    {
      "id": "empty permissions action",
      "actions": ["allow:accounts/read"],
      "permissions": [""],
      "error": "scopie-106 in permission: permission was empty"
    }
  ],
  "validatepermissionsTests": [
    {
      "id": "simple permission",
      "permissions": ["allow:blog/read"]
    },
    {
      "id": "with wildcard",
      "permissions": ["allow:blog/*/read"]
    },
    {
      "id": "with super wildcard",
      "permissions": ["allow:blog/**"]
    },
    {
      "id": "with array",
      "permissions": ["allow:blog/primary|secondary|third/read"]
    },
    {
      "id": "with variable",
      "permissions": ["allow:blog/@owner/read"]
    },
    {
      "id": "combination",
      "permissions": ["allow:blog/*/@region/primary|secondary/**"]
    },
    {
      "id": "invalid special character",
      "permissions": ["allow:blog/:15"],
      "error": "scopie-100: invalid character ':'"
    },
    {
      "id": "variable inside an array group",
      "permissions": ["allow:blog/read|@group|write"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "variable and the end of an array group",
      "permissions": ["allow:blog/read|write|@group"],
      "error": "scopie-101: variable 'group' found in array block"
    },
    {
      "id": "wildcard inside an array group",
      "permissions": ["allow:blog/read|*|write"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "wildcard at the end of an array group",
      "permissions": ["allow:blog/read|write|*"],
      "error": "scopie-102: wildcard found in array block"
    },
    {
      "id": "super wildcard inside an array group",
      "permissions": ["allow:blog/read|**|write"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "super wildcard at the end of an array group",
      "permissions": ["allow:blog/read|write|**"],
      "error": "scopie-103: super wildcard found in array block"
    },
    {
      "id": "super wildcard not in the last block",
      "permissions": ["allow:blog/**/create"],
      "error": "scopie-105: super wildcard not in the last block"
    },
    {
      "id": "empty permission",
      "permissions": [""],
      "error": "scopie-106: permission or action was empty"
    },
    {
      "id": "action then permission",
      "permissions": ["allow:blog/**", "blog/read"],
      "error": "scopie-107: inconsistent array of permissions and actions"
    },
    {
      "id": "permission then action",
      "permissions": ["blog/**", "allow:blog/read"],
      "error": "scopie-107: inconsistent array of permissions and actions"
    },
    {
      "id": "empty permission at second index",
      "permissions": ["allow:blog/**", ""],
      "error": "scopie-106: permission or action was empty"
    }
  ],
  "benchmarks": [
    {
      "id": "allow,1actions,1action,1block1length",
      "actions": ["allow:A"],
      "permissions": ["A"],
      "result": true
    },
    {
      "id": "deny,1actions,1action,1block1length",
      "actions": ["deny:A"],
      "permissions": ["A"],
      "result": false
    },
    {
      "id": "allow,5actions,3permissions,3blocks10length,best",
      "actions": ["allow:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "allow:buzzworthy/bemuzzling/jazzercise"],
      "permissions": ["razzmatazz/vajazzling/buckjumper", "buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging"],
      "result": true
    },
    {
      "id": "allow,5actions,3permissions,3blocks10length,worst",
      "actions": ["allow:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "allow:buzzworthy/bemuzzling/jazzercise"],
      "permissions": ["buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging", "buzzworthy/bemuzzling/jazzercise"],
      "result": true
    },
    {
      "id": "deny,5actions,3permissions,3blocks10length,best",
      "actions": ["deny:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "allow:buzzworthy/bemuzzling/jazzercise"],
      "permissions": ["razzmatazz/vajazzling/buckjumper", "buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging"],
      "result": false
    },
    {
      "id": "deny,5actions,3permissions,3blocks10length,worst",
      "actions": ["allow:razzmatazz/vajazzling/buckjumper", "allow:blackjacks/unpuzzling/unmuzzling", "allow:jumboizing/embezzling/buckjumped", "allow:whizzbangs/squeezebox/puzzlingly", "deny:buzzworthy/bemuzzling/jazzercise"],
      "permissions": ["buzzphase/dizzingly/puzzlement", "schemozzle/scuzzballs/zigzagging", "buzzworthy/bemuzzling/jazzercise"],
      "result": false
    },
    {
      "id": "allow,2actions,1action,3block5length,3array,best",
      "actions": ["allow:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "allow:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "permissions": ["pzazz/jazzy/buzzy"],
      "result": true
    },
    {
      "id": "allow,2actions,1action,3block5length,3array,worst",
      "actions": ["allow:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "allow:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "permissions": ["abuzz/frizz/mezzo"],
      "result": true
    },
    {
      "id": "deny,2actions,1action,3block5length,3array,best",
      "actions": ["deny:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "allow:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "permissions": ["pzazz/jazzy/buzzy"],
      "result": false
    },
    {
      "id": "deny,2actions,1action,3block5length,3array,worst",
      "actions": ["allow:pzazz|bezzy|bizzy/jazzy|fizzy|pozzy/buzzy|fuzzy|muzzy", "deny:whizz|zhuzh|abuzz/scuzz|dizzy|frizz/huzza|mezza|mezzo"],
      "permissions": ["abuzz/frizz/mezzo"],
      "result": false
    },
    {
      "id": "allow,3actions,1action,3block5length,3variables,best",
      "actions": ["allow:@name01/@name02/@name03", "allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack"],
      "permissions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": true
    },
    {
      "id": "allow,3actions,1action,3block5length,3variables,worst",
      "actions": ["allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack", "allow:@name01/@name02/@name03"],
      "permissions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": true
    },
    {
      "id": "deny,2actions,1action,3block5length,3variables,best",
      "actions": ["deny:@name01/@name02/@name03", "allow:quick/zappy/zippy", "allow:jacks/jocko/jugum"],
      "permissions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": false
    },
    {
      "id": "deny,2actions,1action,3block5length,3variables,worst",
      "actions": ["allow:quick/zappy/zippy", "allow:jacks/jocko/jugum", "deny:@name01/@name02/@name03"],
      "permissions": ["value01/value02/value03"],
      "variables": {
          "name01": "value01",
          "name02": "value02",
          "name03": "value03"
      },
      "result": false
    },
    {
      "id": "allow,3actions,1action,3block5length,wildcard,best",
      "actions": ["allow:jivey/*/juicy", "allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack"],
      "permissions": ["jivey/juked/juicy"],
      "result": true
    },
    {
      "id": "allow,3actions,1action,3block5length,wildcard,worst",
      "actions": ["allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack", "allow:juffs/*/jaggy"],
      "permissions": ["juffs/jokey/jaggy"],
      "result": true
    },
    {
      "id": "deny,2actions,1action,3block5length,wildcard,best",
      "actions": ["deny:khazi/*/pujah", "allow:quick/zappy/zippy", "allow:jacks/jocko/jugum"],
      "permissions": ["khazi/zincy/pujah"],
      "result": false
    },
    {
      "id": "deny,2actions,1action,3block5length,wildcard,worst",
      "actions": ["allow:quick/zappy/zippy", "allow:jacks/jocko/jugum", "deny:zilch/*/kanzu"],
      "permissions": ["zilch/karzy/kanzu"],
      "result": false
    },
    {
      "id": "allow,3actions,1action,3block5length,superwildcard,best",
      "actions": ["allow:jivey/**", "allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack"],
      "permissions": ["jivey/juked/juicy"],
      "result": true
    },
    {
      "id": "allow,3actions,1action,3block5length,superwildcard,worst",
      "actions": ["allow:jimmy/jimpy/junky", "allow:mujik/muzak/quack", "allow:juffs/**"],
      "permissions": ["juffs/jokey/jaggy"],
      "result": true
    },
    {
      "id": "deny,2actions,1action,3block5length,superwildcard,best",
      "actions": ["deny:khazi/**", "allow:quick/zappy/zippy", "allow:jacks/jocko/jugum"],
      "permissions": ["khazi/zincy/pujah"],
      "result": false
    },
    {
      "id": "deny,2actions,1action,3block5length,superwildcard,worst",
      "actions": ["allow:quick/zappy/zippy", "allow:jacks/jocko/jugum", "deny:zilch/**"],
      "permissions": ["zilch/karzy/kanzu"],
      "result": false
    }
  ]
}
