{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Scopie","text":"<p>Scopie is a small, explicit, scope-based authorization engine.</p> <p>It evaluates hierarchical permission patterns against requested actions using a deterministic, spec-defined algorithm. Scopie is designed to be embedded directly into applications and services, without requiring a policy server, DSL, or external data source.</p> <p>Scopie follows clarity and explicit behavior over flexibility.</p>"},{"location":"#status","title":"Status","text":"<p>Scopie is currently in alpha.</p> <p>Behavior is versioned and defined by the <code>scenarios.json</code> file. Implementations are expected to conform exactly to the scenarios for their supported version.</p>"},{"location":"#what-scopie-is-and-is-not","title":"What Scopie Is (and Is Not)","text":""},{"location":"#scopie-is","title":"Scopie is:","text":"<ul> <li>A deterministic scope evaluator</li> <li>Based on hierarchical paths, wildcards, arrays, and variables</li> <li>Explicit allow vs deny semantics</li> <li>Langauge agnostic via a shared specification</li> <li>Easy to reason about and test</li> <li>??? data owned by you</li> </ul>"},{"location":"#scopie-is-not","title":"Scopie is not:","text":"<ul> <li>A policy engine</li> <li>A role management system</li> <li>An attribute-based authorization framework</li> <li>A centralized policy service</li> </ul> <p>If you need expressive policy languages, dynamic external lookups, or centralized policy distribution, Scopie is likely not the right tool.</p>"},{"location":"#core-concepts","title":"Core Concepts","text":""},{"location":"#permissions-and-actions","title":"Permissions and Actions","text":"<p>A permission that would allow or deny access:</p> <pre><code>allow:blog/read\ndeny:admin/**\n</code></pre> <p>An action is a concrete request being evaluated:</p> <pre><code>blog/read\n</code></pre> <p>Scopie evaluates an action against a set of granted permissions.</p>"},{"location":"#hierarchy-and-wildcards","title":"Hierarchy and Wildcards","text":"<p>Permissions are hierarchical and path-based.</p> <ul> <li><code>*</code> matches exactly one path segment</li> <li><code>**</code> matches one or more path segments</li> <li>Arrays (<code>|</code>) match one of several values</li> </ul> <p>Examples:</p> <pre><code>allow:blog/*/read\nallow:admin/**\nallow:reports/public|private/read\n</code></pre>"},{"location":"#variables","title":"Variables","text":"<p>Permissions may include variables that are substituted at evaluation time:</p> <pre><code>allow:tenant/@tenant_id/**\n</code></pre> <p>Variables are simple substitutions, not expressions or conditions.</p>"},{"location":"#evaluation-model","title":"Evaluation Model","text":"<p>Scopie's evaluation rules are intentionally simple and explicit.</p> <p>Given a set of permissions and an action:</p> <ol> <li>Permissions are evaluated in sequence.</li> <li>If a matching deny permission is found, evaluation immediately stops and access is denied.</li> <li>If a matching allow permission is found, it is recorded and evaluation continues only for deny permissions.</li> <li>If evaluation completes with at least one matching allow and no matching deny, access is allowed.</li> <li>If no permissions match, access is denied.</li> </ol> <p>This short-circuit behavior is deterministic and does not affect the final result:</p> <ul> <li>Deny always overrides allow</li> <li>Permission order does not change outcomes</li> </ul>"},{"location":"#specification-and-scenarios","title":"Specification and Scenarios","text":"<p>Scopie is spec-first.</p> <p>The scenarios.json defines the normative behavior of Scopie across:</p> <ul> <li>Allow and deny precedence</li> <li>Wildcard and super-wildcard semantics</li> <li>Variable substitution</li> <li>Invalid input handling</li> <li>Determinism and order invariance</li> <li>A cross-language conformance suite</li> </ul> <p>All Scopie implementations must conform to these scenarios. If you want to understand exactly how Scopie behaves, then this is the place to look.</p>"},{"location":"#example","title":"Example","text":"<p>A portion of our application is around building, running and responding to financial reports. We run half, quarterly, monthly and weekly reports.</p> <p>Verbs</p> <ol> <li>Edit: Modify how the report is built</li> <li>Run: Manually run the report</li> <li>Read: Read the reports in our tool</li> <li>Approve: Sign off on the report, approved reports would then be shared</li> <li>Delete: Remove an invalid or broken report</li> </ol> <p>Format</p> <p>For the above reasons we are going to specify our permissions and actions as: <pre><code>reports/&lt;duration&gt;/&lt;action&gt;\n</code></pre></p> <p>We could expand this later to include some sort of organization or business group but for this example, we will keep it simple.</p> <p>Users</p> <ol> <li>Maya is allowed to do everything ( the boss ) <pre><code>allow:**\n</code></pre></li> <li>Adam is allowed to edit and read any report ( makes changes to the queries ) <pre><code>allow:reports/*/edit|read\n</code></pre></li> <li>Tyler can only read reports ( reviews reports but doesn't need to approve them ) <pre><code>allow:reports/*/read\n</code></pre></li> <li>Elisa can do everything but delete ( mostly there to approve, but occasionally edits queries ) <pre><code>allow:reports/*/*\ndeny:reports/*/delete\n</code></pre></li> <li>Jenna can edit and read but only the weekly reports ( a new hire working up ) <pre><code>allow:reports/weekly/edit|read\n</code></pre></li> </ol>"},{"location":"#quick-intro","title":"Quick Intro","text":"<p>See implementations for more complete guides per language.</p> JavascriptTypescriptGoPython <pre><code>import { isAllowed } from \"scopie\";\n\nconst users = {\n    elsa: {\n        permissions: [\"allow:blog/create|update\"],\n    },\n    bella: {\n        permissions: [\"allow:blog/create\"],\n    },\n]\nconst blogPosts = {}\n\nfunction createBlog(username, blogSlug, blogContent) {\n    const user = users[username]\n    if (isAllowed([\"blog/create\"], user.permissions)) {\n        blogPosts[blogSlug] = {\n            author: user,\n            content: blogContent,\n        }\n    }\n}\n\nfunction updateBlog(username, blogSlug, blogContent) {\n    const user = users[username]\n    if (isAllowed([\"blog/update\"], user.permissions)) {\n        blogPosts[blogSlug] = {\n            author: user,\n            content: blogContent,\n        }\n    }\n}\n</code></pre> <pre><code>import { isAllowed } from \"scopie\";\n\ntype User = {\n    permissions: Array&lt;string&gt;;\n};\n\ntype BlogPost = {\n    author: User;\n    content: string;\n}\n\ntype UserStore = {\n    [key: string]: User\n}\n\ntype BlogStore = {\n    [key: string]: BlogPost\n}\n\nconst users: UserStore = {\n    elsa: {\n        permissions: [\"allow:blog/create|update\"],\n    },\n    bella: {\n        permissions: [\"allow:blog/create\"],\n    },\n}\n\nconst blogPosts: BlogStore = {}\n\nfunction createBlog(username: string, blogSlug: string, blogContent: string) {\n    const user = users[username]\n    if (isAllowed([\"blog/create\"], user.permissions)) {\n        blogPosts[blogSlug] = {\n            author: user,\n            content: blogContent,\n        }\n    }\n}\n\nfunction updateBlog(username: string, blogSlug: string, blogContent: string) {\n    const user = users[username]\n    if (isAllowed([\"blog/update\"], user.permissions)) {\n        blogPosts[blogSlug] = {\n            author: user,\n            content: blogContent,\n        }\n    }\n}\n</code></pre> <pre><code>import (\n    \"errors\"\n    \"github.com/miniscruff/scopie-go\"\n)\n\ntype User struct {\n    Permissions []string\n}\n\ntype BlogPost struct {\n    Author  User\n    Content string\n}\n\nvar userStore map[string]User = map[string]User{\n    \"elsa\": User{\n        Permissions: []string{\"allow:blog/create|update\"},\n    },\n    \"belle\": User{\n        Permissions: []string{\"allow:blog/create\"},\n    },\n}\nvar blogStore map[string]BlogPost = map[string]BlogPost{}\n\nfunc createBlog(username, blogSlug, blogContent string) error {\n    user := users[username]\n    allowed, err := scopie.IsAllowed([]string{\"blog/create\"}, user.Permissions, nil)\n    if err != nil {\n        return err\n    }\n\n    if !allowed {\n        return errors.New(\"not allowed to create a blog post\")\n    }\n\n    blogStore[blogSlug] = BlogPost{\n        Author: user,\n        Content: blogContent,\n    }\n    return nil\n}\n\nfunc updateBlog(username, blogSlug, blogContent string) error {\n    user := users[username]\n    allowed, err := scopie.IsAllowed([]string{\"blog/update\"}, user.Permissions, nil) {\n    if err != nil {\n        return err\n    }\n\n    if !allowed {\n        return errors.New(\"not allowed to update this blog post\")\n    }\n\n    blogPosts[blogSlug] = BlogPost{\n        author: user,\n        content: blogContent,\n    }\n    return nil\n}\n</code></pre> <pre><code>from scopie import is_allowed\n\nusers = {\n    \"elsa\": {\n        \"permissions\": [\"allow:blog/create|update\"],\n    },\n    \"bella\": {\n        \"permissions\": [\"allow:blog/create\"],\n    },\n}\n\nblogPosts = {}\n\ndef create_blog(username, blogSlug, blogContent):\n    user = users[username]\n    if is_allowed([\"blog/create\"], user[\"permissions\"]):\n        blogPosts[blogSlug] = {\n            \"author\": user,\n            \"content\": blogContent,\n        }\n\ndef update_blog(username, blogSlug, blogContent):\n    user = users[username]\n    if is_allowed([\"blog/update\"], user[\"permissions\"]):\n        blogPosts[blogSlug] = {\n            \"author\": user,\n            \"content\": blogContent,\n        }\n</code></pre>"},{"location":"implementations/","title":"Official Implementations","text":""},{"location":"implementations/#go","title":"Go","text":""},{"location":"implementations/#javascript","title":"Javascript","text":""},{"location":"implementations/#python","title":"Python","text":""},{"location":"implementations/#community-implementations","title":"Community Implementations","text":"<p>Reach out to get your project listed here.</p>"},{"location":"implementations/#requirements","title":"Requirements","text":"<ol> <li>Create public functions matching the interface as defined in functions</li> <li>Handle all the scenarios defined in the scenarios.json</li> <li>Depending on language you may have to alter the function to be more ergonomic while keeping the functionality</li> <li>Create a pull request to get listed above</li> </ol>"},{"location":"playground/","title":"Playground","text":"<p>Try out permissions and actions in scopie to determine if the user would be allowed to run that action.</p>"},{"location":"playground/#permissions","title":"Permissions","text":"allow:blog/create|update allow:accounts/read  Valid"},{"location":"playground/#actions","title":"Actions","text":"blog/create  Valid"},{"location":"playground/#result","title":"Result","text":"Is Allowed"},{"location":"examples/","title":"Examples","text":"<p>Permission and actions for sample projects.</p>"},{"location":"examples/#github-access-token","title":"GitHub Access Token","text":""},{"location":"examples/#discord-permissions","title":"Discord Permissions","text":""},{"location":"examples/discord_permissions/","title":"Discord Permissions","text":"<p>Discord users role based authorization for server administration. Below is an example of how you might go about supporting the same level of control but using scopie and permission based actions.</p> <p>Not all discord permissions are listed below.</p>"},{"location":"examples/discord_permissions/#server-actions","title":"Server actions","text":"<p>Our structure for discord permissions is <code>(allow or deny):server/&lt;server_id&gt;/&lt;group&gt;/&lt;verb&gt;</code>. This is to allow us to define permissions across different servers while allowing us to also create different namespaces for permissions separate from servers later. It is also possible to separate server permissions completely from other servers, rather then trying to compare the server id within the permission.</p> Group Action Description channels create Create new channels channels update Update channel values channels view View channels expressions create Add custom emojis, stickers, and sounds expressions update Update existing custom expressions expressions remove Remove custom expressions webhooks create Create new webhooks webhooks update Update existing webhooks webhooks remove Remove webhooks members kick Kick other members members ban Ban other members members invite Invite new members messages send Able to send messages messages threads Able to send messages to threads messages links Able to send links in messages messages files Able to send files in messages messages reactions Able to react to messages"},{"location":"examples/discord_permissions/#example-permissions","title":"Example Permissions","text":"<p>Here are a small list of examples permissions. Note that not all of these are practical and would be used in a real scenario.</p>"},{"location":"examples/discord_permissions/#super-wildcards","title":"Super wildcards","text":"Permission Description <code>allow:**</code> Access to everything <code>allow:server/**</code> Access to everything on any server <code>allow:server/&lt;server_id&gt;/**</code> Access to everything on one server <code>allow:server/&lt;server_id&gt;/&lt;group&gt;/**</code> Access all actions related to a group <p>Note that the last example woudl work the same with a normal wildcard.</p>"},{"location":"examples/discord_permissions/#wildcards","title":"Wildcards","text":"Permission Description <code>allow:server/*/...</code> Access to actions on any server <code>allow:server/&lt;server_id&gt;/*/...</code> Access to actions on one server"},{"location":"examples/github_token/","title":"GitHub Access Tokens","text":"<p>If you ever needed to create an access token for GitHub this example attempts to match the same level of control using scopie. For brevity reasons, only the permissions related to repositories are listed.</p>"},{"location":"examples/github_token/#repository-permissions","title":"Repository permissions","text":"<p>Our structure for repository permissions is <code>(allow or deny):repo/&lt;org&gt;/&lt;repo&gt;/&lt;group&gt;/&lt;action&gt;</code>. This allows us to create organization, user or other permissions in a separate top level namespace, such that wildcards and super wildcards are grouped at the top level.</p> Group Action Description status read Read commit status deployments read Read deployment status invites read Read invitations invites write Send invitations to other users security_events read Read security events workflow update Update GitHub action workflows packages upload Upload packages to GitHub package registry packages read Read packages from GitHub package registry packages delete Delete packages to GitHub package registry hooks write Write repository hooks hooks update Update repository hooks hooks delete Delete repository hooks discussions read Read discussions discussions create Create a new discussion discussions comment Comment on an existing discussion discussions delete Delete a discussion audits read Read the audit log"},{"location":"examples/github_token/#full-control-options","title":"Full control options","text":"<p>Under the GitHub UI you can select the group headers to create tokens with full control over that group. The equilivent to that in scopie is using wildcards.</p> <p>For example, full control over the \"discussion\" actions, would be: <pre><code>allow:repo/&lt;org&gt;/&lt;repo&gt;/discussions/*\n</code></pre></p>"},{"location":"examples/github_token/#example-permissions","title":"Example permissions","text":"<p>Here are a small list of examples permissions. Not all of these would make sense in practice.</p>"},{"location":"examples/github_token/#super-wildcards","title":"Super wildcards","text":"<p>These permissions relate to using super wildcards for generalized access.</p> Permission Description <code>allow:**</code> Access to everything <code>allow:repo/**</code> Access to everything under any organization <code>allow:repo/&lt;org&gt;/**</code> Access to everything under the organization <code>allow:repo/&lt;org&gt;/&lt;repo&gt;/**</code> Access to everything under the repository <code>allow:repo/&lt;org&gt;/&lt;repo&gt;/&lt;group&gt;/**</code> Access to all actions under the group"},{"location":"examples/github_token/#wildcards","title":"Wildcards","text":"<p>These permissions relate to using wildcards for generalized access.</p> Permission Description <code>allow:repo/*/...</code> Access to actions under any org <code>allow:repo/&lt;org&gt;/*/...</code> Access to actions under any repo <code>allow:repo/&lt;org&gt;/&lt;repo&gt;/*/...</code> Access to actions under any group <code>allow:repo/*/*/</code> Access to actions under any org and any repo <p>Note that when permissions have multiple levels of variables you may need to wildcard more then one block. For example if you want to give access for specifically creating hooks ( <code>hooks/create</code> ) on any repository in any organization, you would use <code>allow:repo/*/*/hooks/create</code>.</p> <p>Its possible to give access to any repository in the org as well such as <code>allow:repo/&lt;org&gt;/*/hooks/create</code>.</p> <p>There is also the unlikely scenario of giving access to a specific repository name in any org such as <code>allow:repo/*/docker_images/packages/upload</code> which would give access to upload packages to the \"docker_images\" repository in any organization.</p>"},{"location":"examples/github_token/#variables","title":"Variables","text":"<p>User permissions can include variables that relate to actor attempting to do the action. In our case we are going to use the <code>@username</code> variable which can be used as the organization just like GitHub.</p> Permission Description <code>allow:repo/@username/**</code> Allow our user to do anything in our own organization"},{"location":"specification/","title":"Specification","text":"<p>Scopie is designed as a set of logic actions such that it is possible to evaluate whether or not an action is allowed to take place.</p> <p>A full list of specifications with inputs and outputs are available as a JSON file that implementations should use in there test suite. This file also includes specific tests for benchmarking performance.</p> <ul> <li> <p> Terms</p> <p>Understanding the terminology of Scopie.</p> </li> <li> <p> Functions</p> <p>What functions are defined in scopie implementations.</p> </li> <li> <p> Errors</p> <p>Lookup what errors you may run into.</p> </li> <li> <p> Logic Flow</p> <p>Read about the logic actions for processing authorization.</p> </li> </ul>"},{"location":"specification/bnf/","title":"BNF Notation","text":"<p>Backus Naur Form notation of the scopie parsing rules. Note that just passing BNF is not enough to be a valid permission as there are edge cases not specified. One such example is that super wildcards must be the last block.</p> <pre><code>&lt;literals&gt; ::= ([A-Z] | [a-z] | [0-9] | \"_\" | \"-\")+\n&lt;block_sep&gt; ::= \"/\"\n&lt;array_sep&gt; ::= \"|\"\n&lt;var_prefix&gt; ::= \"@\"\n&lt;wildcard&gt; ::= \"*\"\n&lt;super_wildcard&gt; ::= \"**\"\n&lt;grant_allow&gt; ::= \"allow\"\n&lt;grant_deny&gt; ::= \"deny\"\n&lt;grant_sep&gt; ::= \":\"\n\n&lt;grant_any&gt; ::= &lt;grant_allow&gt; | &lt;grant_deny&gt;\n\n&lt;block_literal&gt; ::= &lt;literals&gt;\n&lt;block_literal_repeated&gt; ::= &lt;block_literal&gt; (&lt;block_sep&gt; &lt;block_literal&gt;)*\n&lt;block_var&gt; ::= &lt;var_prefix&gt; &lt;literals&gt;\n&lt;block_array&gt; ::= &lt;literals&gt; (&lt;array_sep&gt; &lt;literals&gt;)+\n&lt;block_any&gt; ::= &lt;block_literal&gt; | &lt;block_array&gt; | &lt;block_var&gt; | &lt;wildcard&gt; | &lt;super_wildcard&gt;\n\n&lt;action&gt; ::= &lt;block_any&gt; (&lt;block_sep&gt; &lt;block_any&gt;)*\n&lt;permission&gt; ::= &lt;grant_any&gt; &lt;grant_sep&gt; (&lt;block_literal_repeated&gt;)+\n</code></pre>"},{"location":"specification/errors/","title":"Errors","text":"<p>When validating a permission or trying to process a permission or action that has an incorrect format we return or throw errors. To keep consistency across languages we define an error format in the specification and include error messages as part of the validation test suite.</p> <p>Parsing the errors should not be required, this format is aimed at being helpful to log for internal debugging, but are probably not useful for your end users.</p> <p>In cases where you are taking user input and saving a permission, you should use the <code>validate_permission</code> function to check if the provided value is properly formatted. You may also need to do extra processing to make sure the values defined in the permission logically make sense in your system as a whole.</p> <p>Formats: When getting an error processing it will mention whether the invalid data came from a action or permission. <pre><code>scopie-&lt;code&gt;\n    in &lt;permission or action&gt;: &lt;short message&gt;\n</code></pre></p> <p>When using the validation function we omit the permission or action as they are not given. <pre><code>scopie-&lt;code&gt; &lt;short message&gt;\n</code></pre></p> <p>For permissions of <code>[\"blog/:15/read\"]</code>, since <code>:</code> is not allowed in permissions. <pre><code>scopie-100 in permission: invalid character ':'\n</code></pre></p> <p>Errors here are not in any particular order, but just as they are discovered or valiations written. In a lot of cases this will just reiterate the summary of the error but in some it will include variables from the respective permission or action.</p>"},{"location":"specification/errors/#100","title":"100","text":"<p>Invalid character.</p> <p>Scopie only allows letters, numbers, underscore <code>_</code>  and dashes <code>-</code> in literal blocks, any other character is invalid.</p> Valid<pre><code>blog/15/create\n</code></pre> Invalid<pre><code>blog/:15/create\n     ^ invalid character ':'\n</code></pre> Message format<pre><code>invalid character '{character}'\n</code></pre>"},{"location":"specification/errors/#101","title":"101","text":"<p>Variable inside array group.</p> <p>Array blocks can not contain variables and must be the entire block on its own. This is so that variables are used more like namespaces or grouping specifiers and would conflict with array blocks that are one of a few actions or specific namespaces.</p> Valid<pre><code>projects/@project/repository/create\n</code></pre> Invalid<pre><code>projects/acme|sesame|@project/repository/create\n                     ^ variable not allowed inside array group\n</code></pre> Message format<pre><code>variable '{key}' found in array block\n</code></pre>"},{"location":"specification/errors/#102","title":"102","text":"<p>Wildcard in array.</p> <p>Array blocks can not contain wildcards and must be the entire block on its own. Having a wildcard would override any array or literal value.</p> Valid<pre><code>projects/acme/*\n</code></pre> Invalid<pre><code>projects/acme/read|write|*\n</code></pre> Message format<pre><code>wildcard found in array block\n</code></pre>"},{"location":"specification/errors/#103","title":"103","text":"<p>Super wildcard in array</p> <p>Array blocks can not contain super wildcards and must be the entire block on its own. Having a super wildcard would override any array or literal value.</p> Valid<pre><code>projects/acme/**\n</code></pre> Invalid<pre><code>projects/acme/read|write|**\n</code></pre> Message format<pre><code>super wildcard found in array block\n</code></pre>"},{"location":"specification/errors/#104","title":"104","text":"<p>Variable key not found in dictionary.</p> <p>A variable was referenced that does not exist in the variable map or dictionary.</p> Valid<pre><code>vars = { \"project\": \"acme\" }\nprojects/@project/repository/create\n</code></pre> Invalid<pre><code>vars = { \"user\": \"tnt\" }\nprojects/@project/repository/create\n         ^ variable project does not exist\n</code></pre> Message format<pre><code>variable '{key}' not found\n</code></pre>"},{"location":"specification/errors/#105","title":"105","text":"<p>Super wildcard not in the last block</p> <p>A super wildcard will auto match all future blocks, because of this any further blocks would be ignored.</p> Valid<pre><code>projects/repository/**\n</code></pre> Invalid<pre><code>projects/repository/**/create\n</code></pre> Message format<pre><code>super wildcard not in the last block\n</code></pre>"},{"location":"specification/errors/#106","title":"106","text":"<p>Empty permission or action</p> <p>Having an empty permission or action for the user doesn't actually make any sense for authorization and is likely caused by something else. We return an error here instead to hopefully catch this instead of silently denying.</p> Valid<pre><code>accounts/create\n</code></pre> Invalid<pre><code># empty\n</code></pre> Message format<pre><code>permission was empty\n</code></pre>"},{"location":"specification/errors/#107","title":"107","text":"<p>Permission does not start with a grant</p> <p>All permissions must specify the allow or deny grant as the prefix to the permission.</p> Valid<pre><code>allow:accounts/create\n</code></pre> Invalid<pre><code>not-allow:accounts/create\ndenies:root/all\n</code></pre> Message format<pre><code>permission does not start with a grant\n</code></pre>"},{"location":"specification/functions/","title":"Functions","text":"<p>Scopie is designed to work in any language and in virtually any system that can use authorization.</p> <p>The exact interface will vary based on what how each language formats functions, variables and handles errors. Even the order of parameters may vary based on language due to optional or key value support.</p>"},{"location":"specification/functions/#is-allowed","title":"Is Allowed","text":"<p>Returns whether or not the user with the given permissions are allowed to complete the action. Depending on the language, we would also return an error, throw or raise an exception for invalid permissions or actions.</p> Is Allowed<pre><code>is_allowed(\n    # Actions specifies what our user is attempting to do.\n    # Example: [\"accounts/thor/edit\"]\n    actions []string,\n    # Permissions specifies what our user has access to do.\n    # When using more then one permission, they are treated as a series of OR conditions,\n    # and a user will be allowed if they match any of the actions.\n    # Example: [\"allow:accounts/thor/**\"]\n    permissions []string,\n    # An optional dictionary or map of variable to values.\n    # Variable keys should not start with `@`\n    # Example: { \"username\": \"thor\" }\n    variables dict[string, string],\n) -&gt; bool and error or raise/exception expected\n</code></pre>"},{"location":"specification/functions/#validate-permissions","title":"Validate Permissions","text":"<p>Checks the given permissions are valid given the requirements outlined in the specification. Depending on the language, this could return a boolean and throw an error, return an error or other language standard.</p> Validate Permissions<pre><code>validate_permissions(\n    # Given permissions to validate.\n    permissions []string,\n) error\n</code></pre>"},{"location":"specification/functions/#validate-actions","title":"Validate Actions","text":"<p>Checks the actions are valid given the requirements outlined in the specification. Depending on the language, this could return a boolean and throw an error, return an error or other language standard.</p> Validate Actions<pre><code>validate_actions(\n    # Given actions to validate.\n    actions []string,\n) error\n</code></pre>"},{"location":"specification/logic/","title":"Allow actions","text":"<p>Scopie flow works as a nested for loop iterating over the actions and permissions.</p>"},{"location":"specification/logic/#matching","title":"Matching","text":"<p>In order for a permission to match a action it must have the same number of blocks, and that every block matches.</p> Mismatched Lengths<pre><code>permissions = [\"acme/accounts/edit\"]\nactions  = [\"allow:accounts/*\"]\n           ^ actions has two levels while required has three\n</code></pre> Mismatched Block<pre><code>permissions = [\"acme/accounts/edit\"]\nactions  = [\"allow:acme/accounts/read\"]\n                               ^ edit does not equal read\n</code></pre>"},{"location":"specification/logic/#deny-break","title":"Deny Break","text":"<p>If a permission matches a deny action, we instantly return false. We do not check until the end of our loops in this case. If any error is present after the deny action match, it will not be found or returned.</p> Deny Break<pre><code>permissions = [\"accounts/edit\"]\nactions  = [\"deny:accounts/*\",\"allow:blogs/*\"]\n                ^ matches    ^ skipped\n</code></pre>"},{"location":"specification/logic/#allow-skips","title":"Allow skips","text":"<p>If an allow action is matched early in the loop, we can skip trying to match any future allow actions as we already matched one. Thus, it is possible to not have errors returned if they are part of actions we skipped.</p> Allow Skip<pre><code>permissions = [\"accounts/edit\"]\nactions  = [\"allow:accounts/*\",\"allow:blogs/*\"]\n           ^ matches          ^ skipped\n</code></pre>"},{"location":"specification/terms/","title":"Terms","text":"<p>Terms and there definitions as it relates to scopie.</p>"},{"location":"specification/terms/#block","title":"Block","text":"<p>Values between slashes that indicate levels of our permission. Can contain one of the following:</p> <ol> <li>A literal string.</li> <li>An array of literal strings separated by pipe (<code>|</code>) characters that are treated as an OR list.</li> <li>A literal string prefixed by an at (<code>@</code>) that is translated to a value from our variable map.</li> <li>A single asterisk (<code>*</code>) that will auto match any value, known as a wildcard.</li> <li>Two asterisks (<code>**</code>) that matches the rest of the action.</li> </ol> Block examples<pre><code>value\none|two|three\n@user_name\n*\n**\n</code></pre>"},{"location":"specification/terms/#action","title":"Action","text":"<p>One or more literal blocks, joined by a slash (<code>/</code>) indicating what the user is attempting to do.</p> Permission examples<pre><code>alpha/beta/omega\nbucket/images/upload\naccount/root/view\n</code></pre>"},{"location":"specification/terms/#grant","title":"Grant","text":"<p>Whether or not the user is allowed to do the action. Either the literal string <code>allow</code> or <code>deny</code>.</p>"},{"location":"specification/terms/#permission","title":"Permission","text":"<p>Permissions are blocks separated by slashes (<code>/</code>). Colons are used to separate the grant from the blocks. Permissions are attached to users.</p> Action examples<pre><code>allow:bucket/images/upload\ndeny:account/**\nallow:blog/@user/read|write\nallow:accounts/**\n</code></pre>"},{"location":"specification/terms/#keywords","title":"Keywords","text":"<p>They may not be explicity checked but it is important not to use any scopie keywords when defining permissions and actions as they may have unintended side effects.</p> <ul> <li>allow</li> <li>deny</li> </ul>"}]}